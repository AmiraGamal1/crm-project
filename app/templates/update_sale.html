{% extends 'base.html' %}

{% block head %}
<title>CRM</title>
{% endblock %}

{% block body %}

<div class="content">
    {% block navbar %}
    <div class='topnav'>
        <a class='active' href='/view_sale'>Sales</a>
        <a href='/view_product'>Products</a>
        <a href='/view_customer'>Customers</a>
        {% if current_user.has_role('admin') or current_user.has_role('supervisor')%}
        <a href='/view_user'>Users</a>
        {% endif %}
        <a class='logout' href='/logout'>Logout</a>
    </div>
    {% endblock %}
    <div class="add_update">
        <div class="form-box">
            <h1  style="text-align: center;">Update sale information</h1>
            <form action="/update_sale/{{sale.id}}" method="post">
                <div class="input-group">
                    <label>Product</label>
                    <div class="input-field {% if error == 'Product not found' %}error-field{% endif %}">
                        <input type="text" name="product" id="product" value="{{ sale.product_name }}" required>
                        {% if error == 'product not found' %}
                        <div class="error-mesg">{{ error }}</div>
                        {% endif %}
                    </div>
                </div>
                <div class="input-group">
                    <label>Quantity</label>
                    <div class="input-field {% if error == 'Not enough quantity' %}error-field{% endif %}">
                        <input type="number" name="quantity" id="quantity" value="{{ sale.product_quantity }}" required>
                        {% if error == 'Not enough quantity' %}
                        <div class="error-mesg">{{ error }}</div>
                        {% endif %}
                    </div>
                </div>
                <div class="input-group">
                    <label>Customer</label>
                    <div class="input-field">
                        <input type="text" name="customer" id="customer" value="{{ sale.customer_name }}" required>
                    </div>
                </div>
                <div class="input-group">
                    <label>Customer email</label>
                    <div class="input-field">
                        <input type="email" name="customer_email" id="customer" value="{{ sale.customer_email }}" required>
                    </div>
                </div>
                <div class="input-group">
                    <label>Customer phone</label>
                    <div class="input-field">
                        <input type="tel" name="customer_phone" value="{{ sale.customer_phone }}" id="customer">
                    </div>
                </div>
                <div class="input-group">
                    <label>user</label>
                    <div class="input-field">
                        <input type="text" name="user" id="user" value="{{ sale.user_name }}" required>
                    </div>
                </div>   
                <div class="input-field">
                    {% if current_user.has_role('admin') or current_user.has_role('editor')%}
                    <input type="submit" value="Update" name="add" id="add">
                    {% endif %}
                </div> 
            </form>  
        </div>
    </div>
</div>
{% endblock %}